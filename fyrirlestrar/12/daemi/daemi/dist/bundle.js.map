{"version":3,"file":"bundle.js","sources":["../src/lib/countdown.js","../src/index.js"],"sourcesContent":["/**\n * Niðurteljari!\n */\nexport default class Countdown {\n  /**\n   * Finnur container fyrir niðurteljara og form.\n   * Bindur submit eventhandler við form.\n   */\n  constructor() {\n    this.keyName = 'countdown';\n    this.container = document.querySelector('.countdown');\n    this.form = document.querySelector('form');\n\n    // til þess að submit hafi þennan klasa sem \"this\" verðum við\n    // að nota bind hér (og í öðrum föllum sem við bindum!)\n    this.form.addEventListener('submit', this.submit.bind(this));\n  }\n\n  /**\n   * Sækir gögn úr localStorage eftir this.keyName\n   * Ef gögn eru til, hleður þeim inn með því að kalla í this.create()\n   */\n  load() {\n    const savedData = window.localStorage.getItem(this.keyName);\n\n    if (savedData) {\n      const parsed = JSON.parse(savedData);\n      const date = new Date(parsed.date);\n\n      this.create(parsed.title, date);\n    }\n  }\n\n  /**\n   * Tekur við title sem streng og date sem Date hlut\n   * Vistar sem json gögn í localStorage undir this.keyName\n   */\n  save(title, date) {\n    const data = { title, date };\n    const json = JSON.stringify(data);\n    window.localStorage.setItem(this.keyName, json);\n  }\n\n  /**\n   * Handler fyrir submit á formi.\n   * Sækir gögn úr formi og kallar í this.parseDate()\n   * Vistar gögn með this.save() og sýnir niðurteljara með this.create()\n   */\n  submit(e) {\n    e.preventDefault();\n    const title = this.form.querySelector('input[type=text]');\n    const date = this.form.querySelector('input[type=date]');\n    const time = this.form.querySelector('input[type=time]');\n\n    const parsedDate = this.parseDate(date.value, time.value);\n\n    this.save(title.value, parsedDate);\n    this.create(title.value, parsedDate);\n  }\n\n  /**\n   * Tekur við:\n   *  - date sem streng á forminu \"yyyy-mm-dd\", t.d. \"2017-11-06\"\n   *  - time sem streng á forminu \"hh:mm\", t.d. \"09:00\"\n   * Skilar date hlut með gögnum úr date og time\n   */\n  parseDate(date, time) {\n    const d = date.split('-');\n    const t = time.split(':');\n\n    const year = parseInt(d[0], 10);\n    const month = parseInt(d[1], 10) - 1;\n    const day = parseInt(d[2], 10);\n    const hour = parseInt(t[0], 10);\n    const min = parseInt(t[1], 10);\n\n    return new Date(year, month, day, hour, min);\n  }\n\n  /**\n   * Býr til element fyrir niðurteljara og bætir við this.container\n   * Setur this.date sem dagsetningu sem talið er niður að\n   * Setur this.element sem element sem geymir niðurteljara\n   * Bætir við \"eyða\" takka sem sér um að eyða niðurteljara með this.delete\n   * Byrjar niðurteljara með this.startCounter() og\n   * felur form með this.hideForm()\n   */\n  create(title, date) {\n    this.date = date;\n\n    const h2 = document.createElement('h2');\n    h2.appendChild(document.createTextNode(title));\n    h2.classList.add('countdown__heading');\n    this.container.appendChild(h2);\n\n    const countdown = document.createElement('div');\n    this.container.appendChild(countdown);\n    this.element = countdown;\n\n    const deleteButton = document.createElement('button');\n    deleteButton.appendChild(document.createTextNode('Eyða'));\n    deleteButton.classList.add('button');\n    deleteButton.addEventListener('click', this.delete.bind(this));\n    this.container.appendChild(deleteButton);\n\n    this.startCounter();\n    this.hideForm();\n  }\n\n  /**\n   * Felur form með CSS\n   */\n  hideForm() {\n    this.form.classList.add('form__hidden');\n  }\n\n  /**\n   * Sýnir form með CSS\n   */\n  showForm() {\n    this.form.classList.remove('form__hidden');\n  }\n\n  /**\n   * Byrjar niðurteljara með this.count() og keyrir á 1000ms fresti\n   * með window.setInterval\n   */\n  startCounter() {\n    this.count();\n    this.interval = window.setInterval(this.count.bind(this), 1000);\n  }\n\n  /**\n   * Stöðvar teljara með window.clearInterval\n   */\n  stopCounter() {\n    window.clearInterval(this.interval);\n  }\n\n  /**\n   * Býr til element sem heldur utan um teljara, á forminu:\n   * <div class=\"countdown__box\">\n   *   <span class=\"countdown__num\">num</span>\n   *   <span class=\"countdown__title\">title</span>\n   * </div>\n   * og skilar element\n   */\n  createElement(num, title) {\n    const el = document.createElement('div');\n    el.classList.add('countdown__box');\n    const numEl = document.createElement('span');\n    numEl.classList.add('countdown__num');\n    numEl.appendChild(document.createTextNode(num));\n    const titleEl = document.createElement('span');\n    titleEl.classList.add('countdown__title');\n    titleEl.appendChild(document.createTextNode(title));\n    el.appendChild(numEl);\n    el.appendChild(titleEl);\n\n    return el;\n  }\n\n  /**\n   * Eyðir niðurteljara með því að fjarlægja úr localStorage og\n   * fjarlægja allt úr this.container.\n   * Kallar líka í this.stopCounter() og this.showForm()\n   */\n  delete() {\n    window.localStorage.removeItem(this.keyName);\n\n    this.stopCounter();\n    this.showForm();\n\n    while (this.container.firstChild) {\n      this.container.removeChild(this.container.firstChild);\n    }\n  }\n\n  /**\n   * Tekur við remaining sem eru millisekúndur í dagsetningu sem talið er\n   * niður í.\n   * Útbýr og skilar element sem inniheldur element fyrir daga, klukkustundir,\n   * mínútur og sekúndur þar til remaining gerist. Hver „partur“ er búinn til\n   * með kalli í this.createElement\n   */\n  countdown(remaining) {\n    const totalSecs = remaining / 1000;\n\n    const days = Math.floor(totalSecs / (60 * 60 * 24));\n    const hours = Math.floor((totalSecs / (60 * 60)) % 24);\n    const mins = Math.floor((totalSecs / 60) % 60);\n    const secs = Math.floor(totalSecs % 60);\n\n    const container = document.createElement('div');\n    container.classList.add('countdown__container');\n\n    container.appendChild(this.createElement(days, 'Dagar'));\n    container.appendChild(this.createElement(hours, 'Klst'));\n    container.appendChild(this.createElement(mins, 'Mín'));\n    container.appendChild(this.createElement(secs, 'Sek'));\n\n    return container;\n  }\n\n  /**\n   * Telur niður.\n   * Fjarlægir allt úr this.element (ef eitthvað er þar) og athugar síðan hvort\n   * this.date (dagsetning sem talið er niður að) sé liðin og ef svo er birtir\n   * textann \"Komið!\" og stoppa teljara með this.stopCounter()\n   * Ef ekki liðið uppfærir teljara með því að bæta element úr this.countdown()\n   * við this.element\n   */\n  count() {\n    if (this.element.firstChild) {\n      this.element.removeChild(this.element.firstChild);\n    }\n\n    const diff = this.date - new Date();\n\n    if (diff <= 0) {\n      this.element.appendChild(document.createTextNode('Komið!'));\n      this.stopCounter();\n    } else {\n      const countdown = this.countdown(diff);\n      this.element.appendChild(countdown);\n    }\n  }\n}\n","import Countdown from './lib/countdown';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const countdown = new Countdown();\n  countdown.load();\n});\n"],"names":["Countdown","keyName","container","document","querySelector","form","addEventListener","submit","bind","savedData","window","localStorage","getItem","parsed","JSON","parse","date","Date","create","title","data","json","stringify","setItem","e","preventDefault","time","parsedDate","parseDate","value","save","d","split","t","year","parseInt","month","day","hour","min","h2","createElement","appendChild","createTextNode","classList","add","countdown","element","deleteButton","delete","startCounter","hideForm","remove","count","interval","setInterval","clearInterval","num","el","numEl","titleEl","removeItem","stopCounter","showForm","firstChild","removeChild","remaining","totalSecs","days","Math","floor","hours","mins","secs","diff","load"],"mappings":"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"}